<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analista Conectividad B2B</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="estilos.css">
    <link rel="shortcut icon" href="https://worldvectorlogo.com/static/img/favicon.ico">
</head>
<body>

    <nav class="navbar navbar-custom d-flex justify-content-between align-items-center sticky-top">
        <h1 class="navbar-title">Registro y gestión de casos – Analistas de Conectividad Tg B2B</h1>
        <div>
            <button class="btn btn-sm btn-outline-light me-1" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasConfig" title="Configuración y Dataframe">
                <i class="bi bi-gear-fill"></i>
            </button>
            <button class="btn btn-sm btn-outline-light me-1" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSearch">
                <i class="bi bi-search"></i> Ayuda
            </button>
            <button class="btn btn-sm btn-outline-light" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasProfile">
                <i class="bi bi-person-circle"></i> Usuario
            </button>
        </div>
    </nav>

    <div class="container-fluid-custom">
        
        <div class="card-custom mb-2">
            <div class="d-flex flex-wrap justify-content-center gap-1">
                <div class="btn-group btn-group-sm">
                    <button class="btn btn-primary btn-macro" id="btRed">RED <i class="bi bi-key"></i></button>
                    <button class="btn btn-primary btn-macro" id="btEdatel">EDAT <i class="bi bi-key"></i></button>
                    <button class="btn btn-primary btn-macro" id="btEtp">ETP <i class="bi bi-key"></i></button>
                    <button class="btn btn-primary btn-macro" id="btElite">ELIT <i class="bi bi-key"></i></button>
                    <button class="btn btn-primary btn-macro" id="btFenix">FENIX <i class="bi bi-key"></i></button>
                </div>
                <div class="btn-group btn-group-sm">
                    <button class="btn btn-outline-primary btn-macro" id="btAvaya">AVAYA</button>
                    <button class="btn btn-outline-primary btn-macro" onclick="loginMayuscula()">LOGIN</button>
                    <button class="btn btn-outline-primary btn-macro" id="btLogin">user</button>
                    <button class="btn btn-outline-primary btn-macro" onclick="loginAgregarUne()">@une</button>
                    <button class="btn btn-outline-primary btn-macro" onclick="fecha()">FECHA</button>
                </div>
            </div>
            
            <div class="d-flex flex-wrap justify-content-center gap-1 mt-2">
                <button class="btn btn-sm btn-warning btn-macro" onclick="copiarMacLimpia()">MAC</button>
                <button class="btn btn-sm btn-warning btn-macro" id="btnMac">CPE#</button>
                <button class="btn btn-sm btn-warning btn-macro" id="btnCpe">ONT#</button>
                <button class="btn btn-sm btn-warning btn-macro" onclick="captura('Arris')">Arris</button>
                
                <div class="vr mx-1"></div>
                
                <button class="btn btn-sm btn-primary btn-macro" onclick="generarWord()"><i class="bi bi-file-word"></i> Word</button>
                <button onclick="generarTXT()" class="btn btn-sm btn-dark fw-bold btn-macro ms-2"><i class="bi bi-file-text"></i> Exportar TXT</button>
            </div>
        </div>

        <div class="row g-2">
            
            <div class="col-12 col-xl-5">
                <div class="card-custom h-100" style="display: flex; flex-direction: column;">
                    <div class="card-header-custom">INFORMACIÓN DEL CASO Y CLIENTE</div>

                    <div class="mb-1 d-flex gap-3 ps-1">
                        <div class="form-check form-check-inline m-0">
                            <input class="form-check-input" type="radio" name="radioTipoCaso" id="radINC" value="INC" onclick="seleccionarTipoCaso('INC')" checked>
                            <label class="form-check-label fw-bold small" for="radINC">INC</label>
                        </div>
                        <div class="form-check form-check-inline m-0">
                            <input class="form-check-input" type="radio" name="radioTipoCaso" id="radWO" value="WO" onclick="seleccionarTipoCaso('WO')">
                            <label class="form-check-label fw-bold small" for="radWO">WO</label>
                        </div>
                    </div>

                    <div class="input-group">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('Caso')">#CASO</button>
                        <input type="text" class="form-control status-monitor" id="Caso" placeholder="INC*** / WO***" onkeyup="mayus(this)">
                        <select class="form-select bg-light" id="tipoIncTxt" style="max-width: 110px; font-size: 0.85rem;">
                            <option value="AVANCE">AVANCE</option>
                            <option value="CREAR">CREAR</option>
                        </select>
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('Caso')"><i class="bi bi-trash3"></i></button>
                    </div>

                    <div class="input-group mb-1">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('Nombre')">Nombre</button>
                        <input type="text" class="form-control status-monitor" id="Nombre" placeholder="Nombre" onkeyup="capitalizar(this); actualizarDescripcionAuto()">
                        <select class="form-select" id="Tratamiento" style="max-width: 75px;" onchange="actualizarDescripcionAuto()">
                            <option value="Sr">Sr</option>
                            <option value="Sra">Sra</option>
                        </select>
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('Nombre')"><i class="bi bi-trash3"></i></button>
                    </div>

                    <div class="input-group mb-1">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('Apellido')">Apellido</button>
                        <input type="text" class="form-control status-monitor" id="Apellido" placeholder="Apellido" onkeyup="capitalizar(this); actualizarDescripcionAuto()">
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('Apellido')"><i class="bi bi-trash3"></i></button>
                    </div>

                    <div class="mb-2">
                        <button class="btn btn-label-main w-100" onclick="copiarNombreCompleto()" style="height: 30px; line-height: 1;">
                            <i class="bi bi-person-vcard"></i> Nombre completo
                        </button>
                    </div>

                    <div class="input-group">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('dian1')">NIT</button>
                        <button class="btn btn-label-sub" onclick="cm1_c1c()">Dig</button>
                        <input type="text" class="form-control status-monitor" id="dian1" placeholder="Cédula / NIT" onkeyup="cm1_tecla2()">
                        <input type="text" id="dian2" class="form-control text-center bg-light" style="max-width: 60px;" readonly>
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('dian1','dian2')"><i class="bi bi-trash3"></i></button>
                        <input type="hidden" id="dian3">
                    </div>

                    <div class="input-group">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('IdLlamada')">ID Llam</button>
                        <input type="text" class="form-control status-monitor" id="IdLlamada" placeholder="ID de Avaya / Genesys" oninput="actualizarTitulo()">
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('IdLlamada')"><i class="bi bi-trash3"></i></button>
                    </div>

                    <div class="row g-1 mb-2">
                        <div class="col-6">
                            <div class="input-group m-0">
                                <button class="btn btn-label-main" onclick="copyToClipBoard('Celular')" style="min-width: 70px;">Celular</button>
                                <input type="text" class="form-control status-monitor" id="Celular" placeholder="Móvil">
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="input-group m-0">
                                <button class="btn btn-label-sub" onclick="copyToClipBoard('Fijo')" style="min-width: 60px;">ANI/Tel</button>
                                <input type="text" class="form-control status-monitor" id="Fijo" placeholder="Fijo/ANI">
                            </div>
                        </div>
                    </div>

                    <div class="input-group mb-1">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('Correo')">Correo</button>
                        <input type="text" class="form-control status-monitor" id="Correo" placeholder="email@dominio.com" onkeyup="minus(this);">
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('Correo')"><i class="bi bi-trash3"></i></button>
                    </div>
                    
                    <div class="mb-2 bg-light border rounded px-2 py-1">
                        <div class="form-check m-0">
                            <input class="form-check-input" type="checkbox" id="chkContactoActualizado">
                            <label class="form-check-label fw-bold text-primary small" for="chkContactoActualizado">
                                Contacto Actualizado (Requerido para TXT)
                            </label>
                        </div>
                    </div>

                    <div class="input-group">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('Direccion')">Dirección</button>
                        <input type="text" class="form-control status-monitor" id="Direccion" placeholder="DIRECCIÓN DEL SITIO" onkeyup="mayus(this);">
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('Direccion')"><i class="bi bi-trash3"></i></button>
                    </div>

                    <div class="input-group">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('Empresa')">Empresa</button>
                        <input type="text" class="form-control status-monitor" id="Empresa" placeholder="Empresa" onkeyup="mayus(this);">
                        <button class="btn btn-label-sub ms-1" onclick="copyToClipBoard('Ciudad')">Ciudad</button>
                        <input type="text" class="form-control status-monitor" id="Ciudad" placeholder="Ciudad" onkeyup="capitalizar(this);">
                    </div>

                    <hr class="my-3">

                    <div class="input-group">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('Legado')">ID Serv</button>
                        <input type="text" class="form-control status-monitor" id="Legado" placeholder="ID Servicio" onkeyup="mayus(this);">
                        <button class="btn btn-label-sub ms-1" onclick="copyToClipBoard('Legado2')">S/N</button>
                        <input type="text" class="form-control status-monitor" id="Legado2" placeholder="SERIAL / MAC / SW" onkeyup="mayus(this);">
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('Legado','Legado2')"><i class="bi bi-trash3"></i></button>
                    </div>

                    <div class="input-group">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('acp')">ACP-</button>
                        <input type="text" class="form-control status-monitor" id="acp" placeholder="XXXX" onkeyup="mayus(this);">
                        <button class="btn btn-label-sub ms-1" onclick="copyToClipBoard('anillo')">Anillo</button>
                        <input type="text" class="form-control status-monitor" id="anillo" placeholder="Anillo" onkeyup="mayus(this);">
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('acp','anillo')"><i class="bi bi-trash3"></i></button>
                    </div>

                    <div class="input-group">
                        <button class="btn btn-label-main" onclick="copyToClipBoard('switch1')">Switch</button>
                        <input type="text" class="form-control status-monitor" id="switch1" placeholder="Serial equipo cliente" onkeyup="mayus(this);">
                        <button class="btn btn-label-sub ms-1" onclick="copyToClipBoard('NE')">NE</button>
                        <input type="text" class="form-control status-monitor" id="NE" placeholder="MPLS / NE" onkeyup="mayus(this);">
                        <button class="btn btn-outline-danger btn-trash" onclick="deliteTextbox('switch1','NE')"><i class="bi bi-trash3"></i></button>
                        <button class="btn btn-outline-primary" onclick="cargarDataframe()" title="Cargar desde CSV"><i class="bi bi-arrow-clockwise"></i></button>
                    </div>

                    <div class="mt-3 mb-3 p-2 border rounded bg-light">
                        <label class="script-title mb-2 text-primary">Resumen</label>
                        
                        <div class="d-flex flex-wrap gap-2 mb-2 align-items-center small">
                            <span class="fw-bold text-muted" style="min-width: 70px;">Causa:</span>
                            <label><input type="radio" name="res_causa" value="Sin servicio" onchange="actualizarResumen()"> Sin servicio</label>
                            <label><input type="radio" name="res_causa" value="Lentitud" onchange="actualizarResumen()"> Lentitud</label>
                            <label><input type="radio" name="res_causa" value="Intermitencia" onchange="actualizarResumen()"> Intermitencia</label>
                        </div>

                        <div class="d-flex flex-wrap gap-2 mb-2 align-items-center small">
                            <span class="fw-bold text-muted" style="min-width: 70px;">Servicio:</span>
                            <label><input type="radio" name="res_servicio" value="Internet" onchange="actualizarResumen()"> Internet</label>
                            <label><input type="radio" name="res_servicio" value="Television" onchange="actualizarResumen()"> TV</label>
                            <label><input type="radio" name="res_servicio" value="Telefonia" onchange="actualizarResumen()"> Telefonía</label>
                            <label><input type="radio" name="res_servicio" value="Movilidad" onchange="actualizarResumen()"> Movilidad</label>
                        </div>

                        <div class="d-flex flex-wrap gap-2 mb-2 align-items-center small">
                            <span class="fw-bold text-muted" style="min-width: 70px;">Tecnología:</span>
                            <label><input type="radio" name="res_tec" value="HFC" onchange="actualizarResumen()"> HFC</label>
                            <label><input type="radio" name="res_tec" value="GPON" onchange="actualizarResumen()"> GPON</label>
                            <label><input type="radio" name="res_tec" value="FIBRA" onchange="actualizarResumen()"> FIBRA</label>
                        </div>

                        <div class="input-group mt-2">
                            <button class="btn-label-main" onclick="copyToClipBoard('ResumenGenerado')">Resumen</button>
                            <input type="text" class="form-control" id="ResumenGenerado" placeholder="Se genera automáticamente...">
                        </div>
                    </div>

                    <div class="mt-auto pt-2">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <span class="script-title text-primary"><i class="bi bi-journal-text"></i> Notas adicionales</span>
                            <div>
                                <button class="btn-tool" title="Ampliar nota" onclick="ampliarNota('nota')"><i class="bi bi-arrows-angle-expand"></i></button>
                                <button class="btn btn-sm btn-success py-0 ms-1" onclick="copyToClipBoard('nota')"><i class="bi bi-clipboard"></i></button>
                                <button class="btn btn-sm btn-outline-danger py-0" onclick="deliteTextbox('nota')"><i class="bi bi-trash3"></i></button>
                            </div>
                        </div>
                        <textarea class="form-control" id="nota" rows="4" placeholder="Escriba aquí notas extras..."></textarea>
                    </div>

                </div>
            </div>

            <div class="col-12 col-xl-7">
                <div class="card-custom h-100">
                    <div class="card-header-custom">GESTIÓN Y SCRIPTS</div>

                    <div class="script-block">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                             <span class="script-title">1. Descripción Automática de Llamada</span>
                             <div class="d-flex gap-1">
                                <select class="form-select form-select-sm py-0" id="sel_plantilla_desc" onchange="actualizarDescripcionAuto()" style="width: auto; font-size: 0.75rem;">
                                    <option value="REGISTRAR">REGISTRAR</option>
                                    <option value="AVANCE_MASIVA">Avance: Falla masiva</option>
                                    <option value="AVANCE_INFRA">Avance: Escalado Infra</option>
                                    <option value="AVANCE_TERRENO_VISITA">Avance: Terreno (Visita)</option>
                                    <option value="AVANCE_TERRENO_CONFIRMAR">Avance: Terreno (Confirmar)</option>
                                    <option value="AVANCE_N2">Avance: Escalado N2</option>
                                    <option value="AVANCE_SEGUIMIENTO">Avance: Seguimiento General</option>
                                    <option value="SALIDA">Avance: Llamada Salida</option>
                                </select>
                                <button class="btn btn-success btn-sm py-0" onclick="copyToClipBoard('desc_auto')">Copiar</button>
                                <button class="btn btn-primary btn-sm py-0" onclick="moverContenidoANotas('desc_auto')" title="Mover a Notas Adicionales"><i class="bi bi-arrow-down-left-square"></i></button>
                                <button class="btn btn-outline-danger btn-sm py-0" onclick="deliteTextbox('desc_auto')"><i class="bi bi-trash3"></i></button>
                             </div>
                        </div>
                        
                        <div class="d-flex flex-wrap gap-2 mb-2 text-xs">
                            <label><input type="checkbox" id="chk_cambios" checked onchange="actualizarDescripcionAuto()"> Sin cambios</label>
                            <label><input type="checkbox" id="chk_reinicio" checked onchange="actualizarDescripcionAuto()"> Reinició</label>
                            <label><input type="checkbox" id="chk_conexiones" checked onchange="actualizarDescripcionAuto()"> Cables OK</label>
                            <label><input type="checkbox" id="chk_electricas" checked onchange="actualizarDescripcionAuto()"> Energía OK</label>
                            <label><input type="checkbox" id="chk_dispositivos" checked onchange="actualizarDescripcionAuto()"> Todos Disp.</label>
                        </div>
                        <input type="text" class="form-control form-control-sm mb-1" id="TiempoSinServicio" placeholder="Tiempo sin servicio (Ej: 2 horas)" oninput="actualizarDescripcionAuto()">
                        <textarea class="form-control form-control-sm" id="desc_auto" rows="4" style="font-size: 0.9rem; background: #e9ecef;"></textarea>
                    </div>

                    <div class="script-block">
                        <span class="script-title">2. Tipificación y Guión Rápido</span>
                        <div class="input-group">
                            <select class="form-select form-select-sm" id="guionesGuion" onchange="selecionGuiones()">
                                <option value="">-- Selecciona una opción --</option>
                                <optgroup label="--- TECNOLOGÍA GPON ---">
                                    <option value="GPON_NO_NAVEGA_MASIVA">NO NAVEGA, TT FALLA MASIVA</option>
                                    <option value="GPON_NO_NAVEGA_TERRENO">NO NAVEGA, POSIBLE FALLA MASIVA O TERRENO</option>
                                    <option value="GPON_LOS_ROJO">LOS EN ROJO - TERRENO</option>
                                    <option value="GPON_CONECTA_NO_NAVEGA">CONECTA Y NO NAVEGA</option>
                                    <option value="GPON_INTERMITENCIA">INTERMITENCIA</option>
                                    <option value="GPON_OPERATIVIDAD">OPERATIVIDAD NORMAL EN LA RED DE TIGO</option>
                                </optgroup>
                                <optgroup label="--- TECNOLOGÍA HFC ---">
                                    <option value="HFC_NO_NAVEGA_MASIVA">NO NAVEGA TT DE FALLA MASIVA</option>
                                    <option value="HFC_PERFIL_LDAP">CONECTA Y NO NAVEGA, PERFIL LDAP MAL CONFIGURADO</option>
                                    <option value="HFC_INTERMITENCIA">INTERMITENCIA POR PARAMETROS ALARMADOS</option>
                                    <option value="HFC_OPERATIVIDAD">OPERATIVIDAD NORMAL EN LA RED DE TIGO</option>
                                </optgroup>
                                <optgroup label="--- TECNOLOGÍA FIBRA ---">
                                    <option value="FIBRA_APERTURA_DOBLE_1">APERTURA DOBLE 1 CLIENTE</option>
                                    <option value="FIBRA_APERTURA_EXTREMO">APERTURA DOBLE EXTREMO</option>
                                    <option value="FIBRA_OPERATIVO_PING">SERVICIO OPERATIVO PING</option>
                                </optgroup>
                                <optgroup label="--- DIAGNÓSTICO TV ---">
                                    <option value="TV_HFC_IMAGEN">HFC - Problemas de imagen</option>
                                    <option value="TV_HFC_SIN_SENAL">HFC - Sin señal</option>
                                    <option value="TV_GPON_IMAGEN">GPON - Problemas de imagen</option>
                                </optgroup>
                                <optgroup label="--- OTROS ---">
                                    <option value="2">No responde</option>
                                    <option value="9">Movilidad</option>
                                    <option value="15">VOZ Escalamiento</option>
                                </optgroup>
                            </select>
                            <button class="btn btn-success btn-sm" onclick="copyToClipBoard('observacionesGiones')">Copiar</button>
                            <button class="btn btn-primary btn-sm" onclick="moverContenidoANotas('observacionesGiones')" title="Mover a Notas Adicionales"><i class="bi bi-arrow-down-left-square"></i></button>
                            <button class="btn btn-outline-danger btn-sm btn-trash" onclick="deliteTextbox('observacionesGiones')"><i class="bi bi-trash3"></i></button>
                        </div>
                        <textarea class="form-control" id="observacionesGiones" rows="7" style="font-size: 0.9rem;"></textarea>
                    </div>

                    <div class="script-block">
                        <span class="script-title">3. Diagnóstico y Soporte</span>
                        <div class="d-flex gap-1 mb-1">
                            <select class="form-select form-select-sm" id="AreaConware" style="width: 30%;">
                                <option value="1">N1</option>
                                <option value="2">N2 COMWARE</option>
                                <option value="3">N2 TIGO</option>
                                <option value="4">LC</option>
                                <option value="5">MESA TT</option>
                            </select>
                            <select class="form-select form-select-sm" id="guiones" onchange="selecion()">
                                <option value="s">-- Diagnósticos --</option>
                                <option value="1">DIAGNOSTICO</option>
                                <option value="3">LLAMADA-ENTRANTE</option>
                                <option value="4">LLAMADA-SALIENTE</option>
                                <option value="5">REPRUEBA</option>
                                <option value="6">CORREO ENTRANTE</option>
                            </select>
                            <button class="btn btn-success btn-sm" onclick="copyToClipBoard('observaciones')">Copiar</button>
                            <button class="btn btn-primary btn-sm" onclick="moverContenidoANotas('observaciones')" title="Mover a Notas Adicionales"><i class="bi bi-arrow-down-left-square"></i></button>
                            <button class="btn btn-outline-danger btn-sm btn-trash" onclick="deliteTextbox('observaciones')"><i class="bi bi-trash3"></i></button>
                        </div>
                        <textarea class="form-control" id="observaciones" rows="10" style="font-size: 0.9rem;"></textarea>
                    </div>

                    <div class="script-block">
                        <span class="script-title">4. Resolución / Cierre</span>
                        <div class="input-group">
                            <select class="form-select form-select-sm" id="guiones2" onchange="selecion2()">
                                <option value="s">-- Resolución --</option>
                                <option value="0" style="color:red; font-weight:bold;">RESOLUCIÓN CAPA3</option>
                                <option value="AGENDAMIENTO">AGENDAMIENTO</option>
                                <option value="2">Resolución (Blanco)</option>
                                <option value="3">Sin Respuesta</option>
                                <optgroup label="--- INFRAESTRUCTURA ---">
                                    <option value="APERTURA_DOBLE_1">APERTURA DOBLE 1 CLIENTE</option>
                                    <option value="APERTURA_DOBLE_2">APERTURA DOBLE >2 CLIENTES</option>
                                    <option value="APERTURA_SIMPLE">APERTURA SIMPLE O PREVENTIVO</option>
                                    <option value="RETIRO_EMPALME">RETIRO DESDE EMPALME</option>
                                    <option value="REINGRESO_EMPALME">REINGRESO DE EMPALME</option>
                                </optgroup>
                            </select>
                            <button class="btn btn-success btn-sm" onclick="copyToClipBoard('observaciones2')">Copiar</button>
                            <button class="btn btn-primary btn-sm" onclick="moverContenidoANotas('observaciones2')" title="Mover a Notas Adicionales"><i class="bi bi-arrow-down-left-square"></i></button>
                            <button class="btn btn-outline-danger btn-sm btn-trash" onclick="deliteTextbox('observaciones2')"><i class="bi bi-trash3"></i></button>
                        </div>
                        <textarea class="form-control" id="observaciones2" rows="5" style="font-size: 0.9rem;"></textarea>
                    </div>

                    <div class="text-end mt-3">
                        <button class="btn btn-danger btn-sm" onclick="borrarTodoConConfirmacion()">
                            <i class="bi bi-eraser-fill"></i> Limpiar Todo
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="footer-custom">
            &copy; 2026 Desarrollado por cdiezlop
        </footer>
    </div>

    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasConfig">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title"><i class="bi bi-gear-fill"></i> Configuración</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <h6 class="border-bottom pb-2 mb-3">Dataframe (CSV)</h6>
            <div class="mb-3">
                <label class="form-label small text-muted">Cargar archivo CSV de NEs.</label>
                <input type="file" id="fileDataframe" accept=".csv" class="form-control" onchange="manejarCargaDataframe(event)">
            </div>
            <button class="btn btn-outline-secondary btn-sm w-100" onclick="refrescarDataframe()"><i class="bi bi-arrow-clockwise"></i> Refrescar Memoria CSV</button>

            <h6 class="border-bottom pb-2 mb-3 mt-4">Plantilla Word (Reportes)</h6>
            <div class="mb-3">
                <label class="form-label small text-muted">Cargar plantilla .docx</label>
                <input type="file" id="inputPlantillaWord" accept=".docx" class="form-control mb-2">
                <button onclick="guardarPlantilla()" class="btn btn-success btn-sm w-100">
                    <i class="bi bi-save"></i> Guardar/Actualizar Plantilla
                </button>
                <div id="estadoPlantilla" class="mt-1 small text-success fw-bold"></div>
            </div>
        </div>
    </div>

    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasProfile">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">Credenciales</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <div class="mb-3"><label class="form-label small fw-bold">Usuario</label><input type="text" id="user" class="form-control form-control-sm"></div>
            <div class="mb-3"><label class="form-label small fw-bold">ID Avaya</label><input type="text" id="avaya" class="form-control form-control-sm"></div>
            <hr>
            <div class="mb-2"><label class="form-label small">Pass RED</label><input type="password" id="passRed" class="form-control form-control-sm"></div>
            <div class="mb-2"><label class="form-label small">Pass EDATEL</label><input type="password" id="passEda" class="form-control form-control-sm"></div>
            <div class="mb-2"><label class="form-label small">Pass ETP</label><input type="password" id="passEtp" class="form-control form-control-sm"></div>
            <div class="mb-2"><label class="form-label small">Pass ELITE</label><input type="password" id="passElite" class="form-control form-control-sm"></div>
            <div class="mb-2"><label class="form-label small">Pass FENIX</label><input type="password" id="passFenix" class="form-control form-control-sm"></div>
            <div class="d-grid mt-3"><button class="btn btn-primary btn-sm" id="btSavePass">Guardar</button></div>
        </div>
    </div>

    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasSearch" style="width: 450px;">
        <div class="offcanvas-header bg-info text-dark">
            <h5 class="offcanvas-title">Centro de Información</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <div class="mb-4">
                <h6 class="fw-bold border-bottom pb-1">Buscar NE Edatel / Metro</h6>
                <input type="text" class="form-control form-control-sm mb-1" id="search-NE" placeholder="Buscar..." onkeyup="searchData()">
                <div id="result-container" class="search-results"><ul id="result-list" class="list-unstyled m-0"></ul></div>
            </div>
            <div class="mb-4">
                <h6 class="fw-bold border-bottom pb-1">Notas / Procedimientos</h6>
                <input type="text" class="form-control form-control-sm mb-1" id="search-INFO" placeholder="Buscar en base..." onkeyup="searchInformation()">
                <div id="result-info" class="search-results" style="max-height: 400px; white-space: pre-wrap; font-family: monospace; font-size: 0.75rem;"></div>
            </div>
        </div>
    </div>

    <div style="display:none;">
        <input id="55555" value="55555"><input id="AVAYA" value="51116"><input id="ELITE" value="ELITE">
        <input id="WALVIZVA" value="WALVIZVA"><input id="walvizva" value="walvizva">
        <input id="Remark" value="Incidente/ Descripción (ap simple, doble, retiro, reingreso, potencias) / TT-Pedido de retiro-EG/anillo/ubicación/IP">
        <input id="arroba" value="walvizva@une">
        <input id="Arris" value="arris">
        <input id="Activo" value="Servicio se encuentra Activo."><input id="Online" value="Equipo se encuentra en estado online.">
        <input id="Switch" value="Switch en estado operativo."><input id="Vlans" value="Vlans correctamente configuradas.">
        <input id="Parametros" value="Equipo dentro de rangos óptimos."><input id="Capa3" value="Levantamiento en capa 3.">
        <input id="Equipocliente" value="Equipo administración interna."><input id="Ping" value="Prueba de ping exitosa.">
        <input id="Offline" value="Equipo offline."><input id="Movil" value="Línea activa.">
        <input id="24H" value="Monitoreo 24 horas."><input id="Puerto" value="Sin afectación puerto.">
        <input id="Bri/Rou" value="Modo bridge/router."><input id="" value="">
        <input id="sincronizacion" value="SINCRONIZACION"><input id="instalacion" value="INST-EQUIPO">
        <input id="cambio" value="CAMBIO-EQUIPO"><input id="reuso" value="REUSO-ACCESO">
        <input id="retequipo" value="RETIRO-EQUIPO"><input id="traza" value="T1g0.2021">
        <input id="IMSWEB" value="https://10.54.77.21:8543/spg/login.do?state=0&resultPage=true">
        <input id="une" value="UNE"><input id="000" value="0000000000000000000">
        <input id="consulta_equipo" value="http://10.100.66.199:8082/RepEquiposDireccion.aspx">
        <input id="ubi" value="UBICGENCPE">
        <input id="SEABEL" value="http://unecrm/ecommunications_esn/start.swe?SWECmd=Start&SWEHo=unecrm">
    </div>

    <script src="ProcesosJS/ProcesarDataframe.js"></script> 
    <script src="ProcesosJS/Data_Informacion.js"></script> 
    <script src="ProcesosJS/NeMetro.js"></script>
    <script src="ProcesosJS/Edatel.js"></script>
    <script src="ProcesosJS/SearchLogic.js"></script> 
    <script src="ProcesosJS/Pantalla.js"></script>
    <script src="ProcesosJS/LocalStore.js"></script>
    <script src="ProcesosJS/procesos.js"></script>
    <script src="ProcesosJS/ExportarTxt.js"></script>
    <script src="ProcesosJS/guiones.js"></script>
    <script src="ProcesosJS/plantillasConware.js"></script>
    <script src="ProcesosJS/Resolucion.js"></script>
    <script src="ProcesosJS/CrearTT.js"></script>
    <script src="ProcesosJS/codigo_cmi1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script src="ProcesosJS/pizzip.js"></script>
    <script src="ProcesosJS/docxtemplater.js"></script>
    <script src="ProcesosJS/FileSaver.js"></script>
    <script src="ProcesosJS/GenerarWord.js"></script>
</body>
</html>